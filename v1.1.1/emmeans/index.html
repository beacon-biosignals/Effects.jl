<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Estimated Marginal Means · Effects.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://beacon-biosignals.github.io/Effects.jl/emmeans/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Effects.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Estimated Marginal Means</a><ul class="internal"><li><a class="tocitem" href="#Pairwise-Comparisons"><span>Pairwise Comparisons</span></a></li><li><a class="tocitem" href="#A-Final-Note"><span>A Final Note</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Estimated Marginal Means</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Estimated Marginal Means</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/beacon-biosignals/Effects.jl/blob/main/docs/src/emmeans.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Estimated-Marginal-a.k.a.-Least-Square-Means"><a class="docs-heading-anchor" href="#Estimated-Marginal-a.k.a.-Least-Square-Means">Estimated Marginal a.k.a. Least Square Means</a><a id="Estimated-Marginal-a.k.a.-Least-Square-Means-1"></a><a class="docs-heading-anchor-permalink" href="#Estimated-Marginal-a.k.a.-Least-Square-Means" title="Permalink"></a></h1><p>At their simplest, estimated marginal means, a.k.a least-square means, are just effects: predictions and associated errors computed from a model at specific points on a reference grid. The &quot;marginal&quot; here refers to estimation at the margins of the table, i.e. either averaging over or computing at specific values of other variables, often the means of other variables. Effects.jl provides a convenient interface for computing EM means at all levels of categorical variables and the means of any continuous covariates. An example will make this clear:</p><pre><code class="language-julia hljs">using DataFrames, Effects, GLM, StatsModels, StableRNGs, StandardizedPredictors
rng = StableRNG(42)
growthdata = DataFrame(; age=[13:20; 13:20],
                       sex=repeat([&quot;male&quot;, &quot;female&quot;], inner=8),
                       weight=[range(100, 155; length=8); range(100, 125; length=8)] .+ randn(rng, 16))
model_scaled = lm(@formula(weight ~ 1 + sex * age), growthdata;
                  contrasts=Dict(:age =&gt; ZScore(), :sex =&gt; DummyCoding()))

emmeans(model_scaled)</code></pre><div><div style = "float: left;"><span>2×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">sex</th><th style = "text-align: left;">age</th><th style = "text-align: left;">weight</th><th style = "text-align: left;">err</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">female</td><td style = "text-align: right;">16.5</td><td style = "text-align: right;">112.694</td><td style = "text-align: right;">0.397181</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">male</td><td style = "text-align: right;">16.5</td><td style = "text-align: right;">127.682</td><td style = "text-align: right;">0.397181</td></tr></tbody></table></div><p>(This is the same example data as <a href="../#Interaction-Terms-in-Effects">Interaction Terms in Effects</a>.)</p><p>Notice that we could have achieved the same result by using <code>effects</code> and specifying the levels manually:</p><pre><code class="language-julia hljs">design = Dict(:sex =&gt; [&quot;female&quot;, &quot;male&quot;], :age =&gt; 16.5)
grid = expand_grid(design)
effects!(grid, model_scaled)</code></pre><div><div style = "float: left;"><span>2×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">sex</th><th style = "text-align: left;">age</th><th style = "text-align: left;">weight</th><th style = "text-align: left;">err</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">female</td><td style = "text-align: right;">16.5</td><td style = "text-align: right;">112.694</td><td style = "text-align: right;">0.397181</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">male</td><td style = "text-align: right;">16.5</td><td style = "text-align: right;">127.682</td><td style = "text-align: right;">0.397181</td></tr></tbody></table></div><p><code>emmeans</code> is primarily a convenience function for computing effects on a convenient, pre-defined reference grid. Notably, <code>emmeans</code> includes information by default about all variables, even the ones analyzed only at their typical values. This differs from <code>effects!</code>:</p><pre><code class="language-julia hljs">design = Dict(:sex =&gt; [&quot;female&quot;, &quot;male&quot;])
grid = expand_grid(design)
effects!(grid, model_scaled)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">sex</th><th style = "text-align: left;">weight</th><th style = "text-align: left;">err</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">female</td><td style = "text-align: right;">112.694</td><td style = "text-align: right;">0.397181</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">male</td><td style = "text-align: right;">127.682</td><td style = "text-align: right;">0.397181</td></tr></tbody></table></div><h2 id="Pairwise-Comparisons"><a class="docs-heading-anchor" href="#Pairwise-Comparisons">Pairwise Comparisons</a><a id="Pairwise-Comparisons-1"></a><a class="docs-heading-anchor-permalink" href="#Pairwise-Comparisons" title="Permalink"></a></h2><p>EM means are also useful for post-hoc examination of pairwise differences. This is implemented via the <a href="../api/#Effects.empairs-Tuple{StatsAPI.RegressionModel}"><code>empairs</code></a> function:</p><pre><code class="language-julia hljs">empairs(model_scaled)</code></pre><div><div style = "float: left;"><span>1×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">sex</th><th style = "text-align: left;">age</th><th style = "text-align: left;">weight</th><th style = "text-align: left;">err</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">female &gt; male</td><td style = "text-align: right;">16.5</td><td style = "text-align: right;">-14.9882</td><td style = "text-align: right;">0.561699</td></tr></tbody></table></div><p>Or for a more advanced case:</p><pre><code class="language-julia hljs">using MixedModels
kb07 = MixedModels.dataset(:kb07)
mixed_form = @formula(rt_trunc ~ 1 + spkr * prec * load + (1|item) + (1|subj))
mixed_model = fit(MixedModel, mixed_form, kb07; progress=false)
empairs(mixed_model)</code></pre><div><div style = "float: left;"><span>28×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">spkr</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">rt_trunc</th><th style = "text-align: left;">err</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-189.655</td><td style = "text-align: right;">128.645</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">new</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-158.7</td><td style = "text-align: right;">128.645</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-327.682</td><td style = "text-align: right;">128.645</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">new</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">585.983</td><td style = "text-align: right;">128.645</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">576.028</td><td style = "text-align: right;">128.73</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">new</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">503.358</td><td style = "text-align: right;">128.645</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">327.809</td><td style = "text-align: right;">128.645</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">old &gt; new</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">30.9554</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">old</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-138.027</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">old &gt; new</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">775.638</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">old</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">765.684</td><td style = "text-align: right;">128.688</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">old &gt; new</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">693.013</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">old</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">517.464</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-168.982</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">new</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">744.683</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">734.728</td><td style = "text-align: right;">128.688</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">new</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">662.058</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">486.509</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">old &gt; new</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">913.665</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">903.71</td><td style = "text-align: right;">128.688</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">old &gt; new</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">831.04</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">655.491</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">no</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-9.95474</td><td style = "text-align: right;">128.688</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">new</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-82.625</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-258.174</td><td style = "text-align: right;">128.603</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">old &gt; new</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-72.6703</td><td style = "text-align: right;">128.688</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">old</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-248.219</td><td style = "text-align: right;">128.688</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">28</td><td style = "text-align: left;">new &gt; old</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-175.549</td><td style = "text-align: right;">128.603</td></tr></tbody></table></div><p>If we provide a method for computing the degrees of freedom or an appropriate value, then <code>empairs</code> will also generate test statistics:</p><pre><code class="language-julia hljs">empairs(model_scaled; dof=dof_residual)</code></pre><div><div style = "float: left;"><span>1×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">sex</th><th style = "text-align: left;">age</th><th style = "text-align: left;">weight</th><th style = "text-align: left;">err</th><th style = "text-align: left;">dof</th><th style = "text-align: left;">t</th><th style = "text-align: left;">Pr(&gt;|t|)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">female &gt; male</td><td style = "text-align: right;">16.5</td><td style = "text-align: right;">-14.9882</td><td style = "text-align: right;">0.561699</td><td style = "text-align: right;">12.0</td><td style = "text-align: right;">-26.6838</td><td style = "text-align: right;">4.70971e-12</td></tr></tbody></table></div><p>These degrees of freedom correspond to the denominator degrees of freedom in the associated F-tests.</p><h3 id="Mixed-effects-Models"><a class="docs-heading-anchor" href="#Mixed-effects-Models">Mixed-effects Models</a><a id="Mixed-effects-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-effects-Models" title="Permalink"></a></h3><p>For mixed-effects models, the denominator degrees of freedom are not clearly defined<sup class="footnote-reference"><a id="citeref-GLMMFAQ" href="#footnote-GLMMFAQ">[GLMMFAQ]</a></sup> (nor is it clear that the asymptotic distribution is even F for anything beyond a few special cases<sup class="footnote-reference"><a id="citeref-Bates2006" href="#footnote-Bates2006">[Bates2006]</a></sup>). The fundamental problem is that mixed models have in some sense &quot;more&quot; degrees of freedom than you would expect from naively counting parameters – the conditional modes (BLUPs) aren&#39;t technically parameters, but do somehow contribute to increasing the amount of wiggle-room that the model has for adapting to the data. We can try a few different approaches and see how they differ.</p><p>We&#39;ll use a simplified version of the model above:</p><pre><code class="language-julia hljs">mixed_form2 = @formula(rt_trunc ~ 1 + prec * load + (1|item) + (1|subj))
mixed_model2 = fit(MixedModel, mixed_form2, kb07; progress=false)</code></pre><table><tr><th align="left"></th><th align="right">Est.</th><th align="right">SE</th><th align="right">z</th><th align="right">p</th><th align="right">σ_subj</th><th align="right">σ_item</th></tr><tr><td align="left">&#40;Intercept&#41;</td><td align="right">2441.6881</td><td align="right">84.3815</td><td align="right">28.94</td><td align="right">&lt;1e-99</td><td align="right">318.4042</td><td align="right">363.6708</td></tr><tr><td align="left">prec: maintain</td><td align="right">-676.0779</td><td align="right">48.5432</td><td align="right">-13.93</td><td align="right">&lt;1e-43</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">load: yes</td><td align="right">148.1423</td><td align="right">48.4865</td><td align="right">3.06</td><td align="right">0.0022</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">prec: maintain &amp; load: yes</td><td align="right">17.3034</td><td align="right">68.5904</td><td align="right">0.25</td><td align="right">0.8008</td><td align="right"> </td><td align="right"> </td></tr><tr><td align="left">Residual</td><td align="right">725.2555</td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td><td align="right"></td></tr></table>
<ul><li>the default definition in MixedModels.jl for <code>dof_residual(model)</code> is simply <code>nobs(model) - dof(model)</code></li></ul><pre><code class="language-julia hljs">empairs(mixed_model2; dof=dof_residual)</code></pre><div><div style = "float: left;"><span>6×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">rt_trunc</th><th style = "text-align: left;">err</th><th style = "text-align: left;">dof</th><th style = "text-align: left;">t</th><th style = "text-align: left;">Pr(&gt;|t|)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-148.142</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">1782</td><td style = "text-align: right;">-1.24153</td><td style = "text-align: right;">0.214572</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">676.078</td><td style = "text-align: right;">119.345</td><td style = "text-align: right;">1782</td><td style = "text-align: right;">5.66491</td><td style = "text-align: right;">1.71183e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">510.632</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">1782</td><td style = "text-align: right;">4.27945</td><td style = "text-align: right;">1.97306e-5</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">824.22</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">1782</td><td style = "text-align: right;">6.90687</td><td style = "text-align: right;">6.86976e-12</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">658.775</td><td style = "text-align: right;">119.31</td><td style = "text-align: right;">1782</td><td style = "text-align: right;">5.52152</td><td style = "text-align: right;">3.85549e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-165.446</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">1782</td><td style = "text-align: right;">-1.38641</td><td style = "text-align: right;">0.165794</td></tr></tbody></table></div><ul><li>the leverage formula, given by <code>nobs(model) - sum(leverage(model))</code> (for classical linear models, this is exactly the same as (1))</li></ul><pre><code class="language-julia hljs">empairs(mixed_model2; dof=nobs(mixed_model) - sum(leverage(mixed_model)))</code></pre><div><div style = "float: left;"><span>6×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">rt_trunc</th><th style = "text-align: left;">err</th><th style = "text-align: left;">dof</th><th style = "text-align: left;">t</th><th style = "text-align: left;">Pr(&gt;|t|)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-148.142</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">1704.63</td><td style = "text-align: right;">-1.24153</td><td style = "text-align: right;">0.214579</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">676.078</td><td style = "text-align: right;">119.345</td><td style = "text-align: right;">1704.63</td><td style = "text-align: right;">5.66491</td><td style = "text-align: right;">1.7235e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">510.632</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">1704.63</td><td style = "text-align: right;">4.27945</td><td style = "text-align: right;">1.97767e-5</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">824.22</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">1704.63</td><td style = "text-align: right;">6.90687</td><td style = "text-align: right;">6.97054e-12</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">658.775</td><td style = "text-align: right;">119.31</td><td style = "text-align: right;">1704.63</td><td style = "text-align: right;">5.52152</td><td style = "text-align: right;">3.87932e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-165.446</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">1704.63</td><td style = "text-align: right;">-1.38641</td><td style = "text-align: right;">0.165802</td></tr></tbody></table></div><ul><li>counting each conditional mode as a parameter (this is the most conservative value because it has the smallest degrees of freedom)</li></ul><pre><code class="language-julia hljs">empairs(mixed_model2; dof=nobs(mixed_model) - sum(size(mixed_model)[2:3]))</code></pre><div><div style = "float: left;"><span>6×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">rt_trunc</th><th style = "text-align: left;">err</th><th style = "text-align: left;">dof</th><th style = "text-align: left;">t</th><th style = "text-align: left;">Pr(&gt;|t|)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-148.142</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">1693</td><td style = "text-align: right;">-1.24153</td><td style = "text-align: right;">0.21458</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">676.078</td><td style = "text-align: right;">119.345</td><td style = "text-align: right;">1693</td><td style = "text-align: right;">5.66491</td><td style = "text-align: right;">1.72535e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">510.632</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">1693</td><td style = "text-align: right;">4.27945</td><td style = "text-align: right;">1.9784e-5</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">824.22</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">1693</td><td style = "text-align: right;">6.90687</td><td style = "text-align: right;">6.9866e-12</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">658.775</td><td style = "text-align: right;">119.31</td><td style = "text-align: right;">1693</td><td style = "text-align: right;">5.52152</td><td style = "text-align: right;">3.8831e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-165.446</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">1693</td><td style = "text-align: right;">-1.38641</td><td style = "text-align: right;">0.165803</td></tr></tbody></table></div><ul><li>the infinite degrees of freedom (i.e. interpret <span>$t$</span> as <span>$z$</span> and <span>$F$</span> as <span>$\chi^2$</span> )</li></ul><pre><code class="language-julia hljs">empairs(mixed_model2; dof=Inf)</code></pre><div><div style = "float: left;"><span>6×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">rt_trunc</th><th style = "text-align: left;">err</th><th style = "text-align: left;">dof</th><th style = "text-align: left;">t</th><th style = "text-align: left;">Pr(&gt;|t|)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-148.142</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">-1.24153</td><td style = "text-align: right;">0.214408</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">676.078</td><td style = "text-align: right;">119.345</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">5.66491</td><td style = "text-align: right;">1.47106e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">510.632</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">4.27945</td><td style = "text-align: right;">1.87356e-5</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">824.22</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">6.90687</td><td style = "text-align: right;">4.9548e-12</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">658.775</td><td style = "text-align: right;">119.31</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">5.52152</td><td style = "text-align: right;">3.36087e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-165.446</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">-1.38641</td><td style = "text-align: right;">0.16562</td></tr></tbody></table></div><p>These values are all very similar to each other, because the <span>$t$</span> distribution rapidly converges to the <span>$z$</span> distribution for <span>$t &gt; 30$</span> and so amount of probability mass in the tails does not change much for a model with more than a thousand observations and 30+ levels of each grouping variable.</p><h3 id="Multiple-Comparisons-Correction"><a class="docs-heading-anchor" href="#Multiple-Comparisons-Correction">Multiple Comparisons Correction</a><a id="Multiple-Comparisons-Correction-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Comparisons-Correction" title="Permalink"></a></h3><p>A perhaps more important concern is inflation of Type-1 error rate through multiple testing. We can also provide a correction method to be applied to the p-values.</p><pre><code class="language-julia hljs">using MultipleTesting
bonferroni(pvals) = adjust(PValues(pvals), Bonferroni())
empairs(mixed_model2; dof=Inf, padjust=bonferroni)</code></pre><div><div style = "float: left;"><span>6×7 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">load</th><th style = "text-align: left;">prec</th><th style = "text-align: left;">rt_trunc</th><th style = "text-align: left;">err</th><th style = "text-align: left;">dof</th><th style = "text-align: left;">t</th><th style = "text-align: left;">Pr(&gt;|t|)</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break</td><td style = "text-align: right;">-148.142</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">-1.24153</td><td style = "text-align: right;">1.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">676.078</td><td style = "text-align: right;">119.345</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">5.66491</td><td style = "text-align: right;">8.82634e-8</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">510.632</td><td style = "text-align: right;">119.322</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">4.27945</td><td style = "text-align: right;">0.000112414</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">yes &gt; no</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">824.22</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">6.90687</td><td style = "text-align: right;">2.97288e-11</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">yes</td><td style = "text-align: left;">break &gt; maintain</td><td style = "text-align: right;">658.775</td><td style = "text-align: right;">119.31</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">5.52152</td><td style = "text-align: right;">2.01652e-7</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">no &gt; yes</td><td style = "text-align: left;">maintain</td><td style = "text-align: right;">-165.446</td><td style = "text-align: right;">119.333</td><td style = "text-align: right;">Inf</td><td style = "text-align: right;">-1.38641</td><td style = "text-align: right;">0.993722</td></tr></tbody></table></div><h2 id="A-Final-Note"><a class="docs-heading-anchor" href="#A-Final-Note">A Final Note</a><a id="A-Final-Note-1"></a><a class="docs-heading-anchor-permalink" href="#A-Final-Note" title="Permalink"></a></h2><p>There are many subleties in more advanced applications of EM means. These are discussed at length in the documentation for the R package <code>emmeans</code>. For example:</p><ul><li><a href="https://cran.r-project.org/web/packages/emmeans/vignettes/transformations.html">the impact of transformations and link functions</a></li><li><a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#depcovs">derived covariates</a>, e.g., including both <code>x</code> and <code>x^2</code> in a model</li><li><a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#weights">weighting of cells in computing means</a></li></ul><p>All of these problems are fundamental to EM means as a technique and not particular to the software implementation. Effects.jl does not yet support everything that R&#39;s <code>emmeans</code> does, but all of the fundamental statistical concerns discussed in the latter&#39;s documentation still apply.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-GLMMFAQ"><a class="tag is-link" href="#citeref-GLMMFAQ">GLMMFAQ</a><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#why-doesnt-lme4-display-denominator-degrees-of-freedomp-values-what-other-options-do-i-have">Why doesn’t lme4 display denominator degrees of freedom/p values? What other options do I have?</a></li><li class="footnote" id="footnote-Bates2006"><a class="tag is-link" href="#citeref-Bates2006">Bates2006</a><a href="https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html">lmer, p-values and all that</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 16 November 2023 15:39">Thursday 16 November 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
